import{_ as M,O as Q,b as z,r as G,D as H,d as n,o as v,e as C,f as e,g as t,w as l,n as b,k as h,i as _,F as K,q as R,s as x,t as I,v as S,P as W,L as f,Q as X}from"./index-cc972ea5.js";const Y=["onClick"],Z={__name:"index",setup(ee){let m=Q(),c=z(1),a=G({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),w=()=>{Object.assign(a,{attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),c.value=!1},k=()=>{c.value=!0},B=()=>{a.attrValueList.push({valueName:"",flag:!0})},D=s=>{c.value=!1,Object.assign(a,JSON.parse(JSON.stringify(s)))},O=async s=>{(await W(s)).code==200?(f({type:"success",message:"删除成功"}),m.getCategoryData()):f({type:"success",message:"删除失败"})},P=async()=>{a.categoryId=m.C3Id,(await X(a)).code==200?(f({type:"success",message:a.id?"修改成功":"添加成功"}),m.getCategoryData()):f({type:"success",message:a.id?"修改成功":"添加成功"}),c.value=!1},F=s=>{let p=a.attrValueList[s].valueName;if(!p.trim()){f({type:"error",message:"属性值不能为空"}),a.attrValueList.splice(s,1);return}if(a.attrValueList.some((d,o,u)=>d.valueName===p&&o!=s)){f({type:"error",message:"属性值不能重复"}),a.attrValueList.splice(s,1);return}a.attrValueList[s].flag=!1},U=s=>{a.attrValueList[s].flag=!0};const q={updated(s){s.querySelector("input").focus()}};let j=s=>{a.attrValueList.splice(s,1)};return H(()=>{m.$reset()}),(s,p)=>{const V=n("Category"),d=n("SvgIcon"),o=n("el-button"),u=n("el-table-column"),A=n("el-tag"),T=n("el-popconfirm"),N=n("el-table"),L=n("el-input"),$=n("el-form-item"),E=n("el-form"),J=n("el-card");return v(),C("div",null,[e(V,{scene:t(c)},null,8,["scene"]),e(J,{style:{margin:"10px 0"}},{default:l(()=>[b(h("div",null,[e(o,{type:"primary",disabled:!t(m).C3Id,onClick:t(w)},{default:l(()=>[e(d,{class:"svg",name:"add"}),_(" 添加属性 ")]),_:1},8,["disabled","onClick"]),e(N,{border:"",style:{"margin-top":"20px"},data:t(m).CategoryData},{default:l(()=>[e(u,{label:"序号",type:"index",width:"80",align:"center"}),e(u,{label:"属性名称",width:"150",prop:"attrName"}),e(u,{label:"属性值名称"},{default:l(({row:r,column:g,$index:i})=>[(v(!0),C(K,null,R(r.attrValueList,y=>(v(),x(A,{key:y.id},{default:l(()=>[_(I(y.valueName),1)]),_:2},1024))),128))]),_:1}),e(u,{label:"操作",width:"150"},{default:l(({row:r,column:g,$index:i})=>[e(o,{type:"primary",onClick:y=>t(D)(r)},{default:l(()=>[e(d,{class:"svg no_margin",name:"bianji"})]),_:2},1032,["onClick"]),e(T,{title:"确定删除吗?",onConfirm:y=>t(O)(r.id)},{reference:l(()=>[e(o,{type:"primary"},{default:l(()=>[e(d,{class:"svg no_margin",name:"shanchu"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[S,t(c)]]),b(h("div",null,[e(E,null,{default:l(()=>[e($,{label:"属性名称"},{default:l(()=>[e(L,{class:"input1",placeholder:"请输入属性名称",modelValue:t(a).attrName,"onUpdate:modelValue":p[0]||(p[0]=r=>t(a).attrName=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(o,{type:"primary",disabled:!t(a).attrName,onClick:t(B)},{default:l(()=>[e(d,{class:"svg",name:"add"}),_(" 添加属性值 ")]),_:1},8,["disabled","onClick"]),e(o,{type:"primary",onClick:t(k)},{default:l(()=>[_("取消")]),_:1},8,["onClick"]),e(N,{border:"",data:t(a).attrValueList},{default:l(()=>[e(u,{label:"序号",type:"index",width:"100",align:"center"}),e(u,{label:"属性值名称"},{default:l(({row:r,$index:g})=>[r.flag?b((v(),x(L,{key:0,onBlur:i=>t(F)(g),modelValue:r.valueName,"onUpdate:modelValue":i=>r.valueName=i,placeholder:"请输入属性值"},null,8,["onBlur","modelValue","onUpdate:modelValue"])),[[q]]):(v(),C("div",{key:1,onClick:i=>t(U)(g)},I(r.valueName),9,Y))]),_:1}),e(u,{label:"属性值操作"},{default:l(({row:r,column:g,$index:i})=>[e(o,{type:"danger",onClick:y=>t(j)(i)},{default:l(()=>[e(d,{class:"svg no_margin",name:"shanchu"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(o,{type:"primary",onClick:t(P),disabled:t(a).attrValueList.length<=0},{default:l(()=>[_("确定")]),_:1},8,["onClick","disabled"]),e(o,{type:"primary",onClick:t(k)},{default:l(()=>[_("取消")]),_:1},8,["onClick"])],512),[[S,!t(c)]])]),_:1})])}}},ae=M(Z,[["__scopeId","data-v-12a3e7d9"]]);export{ae as default};
